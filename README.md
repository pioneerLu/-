# 简介

这是一个基于LSTM模型的股价预测和交易项目，利用恒生指数的日线数据与5分钟级数据在投资周期内争取获得最大收益。


## 依赖项

在运行项目之前，您需要安装以下依赖项：

- `matplotlib.`
- `keras`
- `numpy`
- `pandas`
- `sklearn.preprocessing`
- `warnings`（可选）
- `tensorflow`（注意，最好使用2.0版本的tf，避免兼容性问题）
- `backtrader`（用于开发和测试交易策略）
- `datetime`

### 项目运行说明

我们在实际开发项目之前已经进行了数据预处理和特征工程的相关工作，并且在每个文件夹中附上了代码运行所依赖的csv数据和部分已经生成的模型（.h5后缀）。
因此您在使用过程中不需要再次执行数据预处理文件（我们也提供了部分预处理代码，但并不完整）。

# 数据处理以及预测
“Data_processing and Prediction”文件夹中存放了添加RSI新特征的相关代码，以及对股市收盘价进行预测的代码（prediction），两个jupyter文件都可直接运行。prediction文件中的第一个单元格在运行后会生成一个初始模型文件（训练大概需要15min），如果不想跑可以直接使用我们附在文件夹路径下的.h5模型文件（根据代码注释）。第二个单元格的运行需要使用刚刚生成的模型，运行时间大约为50min。

# 模拟交易策略以及仿真投资

“Simulated_trading_results” 文件夹中存放了三种交易策略的代码以及交易仿真的代码（mock_trading）。

mock_trading的jupyter文件可以直接运行得到结果，该jupyter文件中有一个策略单元格（根据Markdown提示），可以将存放三个不同策略的的py文件中的代码复制粘贴到该单元格下，从而获得不同策略下的收益结果。我们在此放置的是策略三（正收益最高的策略）。

img文件夹下存放了三种不同策略的盈利结果可视化图片以供参考。

## 项目运行结果

由于训练代码和交易模拟运行耗时长,我们在相应的文件夹中都已经附上了最终的运行结果以供参考,
包括预测可视化结果，训练过程，以及最终收益可视化情况。
